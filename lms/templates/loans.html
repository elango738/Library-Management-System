{% extends 'layout.html' %}
{% block content %}
  <h2>Loans</h2>
  <table class="table">
    <thead>
      <tr><th>Book</th><th>Borrower</th><th>Issued</th><th>Due</th><th>Returned</th><th>Actions</th></tr>
    </thead>
    <tbody>
      {% for loan in loans %}
      <tr class="{% if loan.is_overdue() %}overdue{% endif %}">
        <td>{{ loan.book.title }}</td>
        <td>{{ loan.borrower.name }}</td>
        <td>{{ loan.issue_date.strftime('%Y-%m-%d') }}</td>
        <td>{{ loan.due_date.strftime('%Y-%m-%d') if loan.due_date else '-' }}</td>
        <td>{{ loan.return_date.strftime('%Y-%m-%d') if loan.return_date else '-' }}</td>
        <td>
          {% if not loan.return_date %}
            {# link to confirmation page before performing return #}
            <a class="btn small" href="{{ url_for('return_book', loan_id=loan.id) }}">Return</a>
          {% else %}
            <span class="muted">Returned</span>
          {% endif %}
        </td>
      </tr>
      {% else %}
      <tr><td colspan="6" class="muted">No loans recorded.</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
